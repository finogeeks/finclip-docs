import{_ as o,c as i,a9 as r,o as t}from"./chunks/framework.BjXht68r.js";const e="/images/promtail-loki.png",g=JSON.parse('{"title":"日志系统","description":"A guide in my new Starlight docs site.","frontmatter":{"title":"日志系统","description":"A guide in my new Starlight docs site."},"headers":[],"relativePath":"docs/monitoring/logging.md","filePath":"docs/monitoring/logging.md"}'),n={name:"docs/monitoring/logging.md"};function l(s,a,h,d,c,m){return t(),i("div",null,a[0]||(a[0]=[r('<h2 id="系统概述" tabindex="-1">系统概述 <a class="header-anchor" href="#系统概述" aria-label="Permalink to &quot;系统概述&quot;">​</a></h2><p>在现代的软件系统运维中，日志收集与分析至关重要。我们的日志收集系统基于 Promtail、Loki 和 Grafana 构建，是一个高效且功能强大的解决方案。它能够从复杂的系统环境中收集日志，对其进行有效的存储和管理，并通过直观的可视化界面帮助运维人员和开发人员快速获取有价值的信息，用于系统监控、故障排查、性能分析、安全审计等多种场景，保障系统的稳定运行和持续优化。</p><p>我们的日志收集系统基于开源组件 Promtail、Loki 和 Grafana 构建了一个高效的日志收集和分析平台，能够实时收集、存储和展示应用服务的日志数据。</p><h2 id="系统架构" tabindex="-1">系统架构 <a class="header-anchor" href="#系统架构" aria-label="Permalink to &quot;系统架构&quot;">​</a></h2><p>如下图所示，日志系统包含 Promtail、Loki 和 Grafana 三个核心组件。Promtail 作为日志收集工具，负责将日志从各个服务中提取并发送到 Loki，Loki 则负责存储日志数据，Grafana 提供强大的日志可视化和查询能力，帮助用户快速定位问题和监控服务健康状况。</p><p><img src="'+e+'" alt=""></p><h2 id="组件介绍" tabindex="-1">组件介绍 <a class="header-anchor" href="#组件介绍" aria-label="Permalink to &quot;组件介绍&quot;">​</a></h2><h3 id="_1-promtail" tabindex="-1">1. Promtail <a class="header-anchor" href="#_1-promtail" aria-label="Permalink to &quot;1. Promtail&quot;">​</a></h3><ul><li><strong>功能</strong>：负责从各个源（如容器、应用日志文件等）收集日志并发送到 Loki。支持通过日志标签对日志进行分类，支持多种日志格式的解析。</li><li><strong>优点</strong>：轻量级，能够高效地从容器和文件系统中收集日志；支持多种日志源的集成，灵活的配置项使得用户可以自定义日志收集策略。</li></ul><h3 id="_2-loki" tabindex="-1">2. Loki <a class="header-anchor" href="#_2-loki" aria-label="Permalink to &quot;2. Loki&quot;">​</a></h3><ul><li><strong>功能</strong>：Loki 是一个水平可扩展的日志聚合系统，类似于 Prometheus，但针对日志数据进行了优化。它将日志存储与索引分开，采用基于时间和标签的索引方式，能够高效地存储和查询大量日志。</li><li><strong>优点</strong>：高效的存储和查询能力，支持与 Promtail 无缝集成；低延迟、分布式架构，能够满足大规模日志数据的需求。</li></ul><h3 id="_3-grafana" tabindex="-1">3. Grafana <a class="header-anchor" href="#_3-grafana" aria-label="Permalink to &quot;3. Grafana&quot;">​</a></h3><ul><li><strong>功能</strong>：Grafana 是一个开源的可视化工具，用于展示来自 Loki 的日志数据。通过 Grafana，用户可以创建强大的仪表盘和图表，支持实时日志的查询、展示和报警。</li><li><strong>优点</strong>：支持多种数据源，强大的可视化能力，灵活的查询功能，丰富的插件生态，便于用户创建自定义的监控视图。</li></ul><h2 id="示例场景" tabindex="-1">示例场景 <a class="header-anchor" href="#示例场景" aria-label="Permalink to &quot;示例场景&quot;">​</a></h2><h3 id="场景-1-日志异常监控" tabindex="-1">场景 1：日志异常监控 <a class="header-anchor" href="#场景-1-日志异常监控" aria-label="Permalink to &quot;场景 1：日志异常监控&quot;">​</a></h3><p>配置日志收集规则，当应用日志中出现关键字（如 &quot;ERROR&quot; 或 &quot;Exception&quot;）时，Loki 将该日志数据存储，并通过 Grafana 创建仪表盘，实时展示异常日志的数量和详细信息，帮助运维人员快速定位问题。</p><h3 id="场景-2-服务响应慢日志告警" tabindex="-1">场景 2：服务响应慢日志告警 <a class="header-anchor" href="#场景-2-服务响应慢日志告警" aria-label="Permalink to &quot;场景 2：服务响应慢日志告警&quot;">​</a></h3><p>在 Grafana 中创建仪表盘，监控各服务的响应时间。当某个服务的响应时间超过 5 秒时，Loki 将记录该事件并将其展示在 Grafana 中。运维人员可在仪表盘中实时查看，快速发现响应慢的服务，并通过设置告警规则通知相关人员。</p><h3 id="场景-3-日志存储优化" tabindex="-1">场景 3：日志存储优化 <a class="header-anchor" href="#场景-3-日志存储优化" aria-label="Permalink to &quot;场景 3：日志存储优化&quot;">​</a></h3><p>随着日志量的增加，需要定期清理不再需要的日志数据。可以在 Loki 中配置日志保留策略，按时间或日志级别进行自动清理，确保日志系统的高效运行并节省存储空间。</p>',20)]))}const p=o(n,[["render",l]]);export{g as __pageData,p as default};
